import com.twenty9ine.frauddetection.domain.valueobject.Transaction
import com.twenty9ine.frauddetection.domain.valueobject.Money
import com.twenty9ine.frauddetection.domain.valueobject.RuleEvaluationResult
import com.twenty9ine.frauddetection.domain.valueobject.RuleTrigger
import com.twenty9ine.frauddetection.domain.valueobject.RuleViolationSeverity

global RuleEvaluationResult ruleEvaluationResult;

rule "Large Amount Transaction"
    when
        $tx : Transaction(
            $money : amount,
            amount.value().doubleValue() > 10000.0
        )
    then
        RuleTrigger trigger = new RuleTrigger(
            "LARGE_AMOUNT",
            "Large Amount",
            RuleViolationSeverity.MEDIUM,
            "Transaction value exceeds $10,000",
            $money.value().doubleValue()
        );
        ruleEvaluationResult.addTrigger(trigger);
end

rule "Very Large Amount Transaction"
    when
        $tx : Transaction(
            $money : amount,
            amount.value().doubleValue() > 50000.0
        )
    then
        RuleTrigger trigger = new RuleTrigger(
            "VERY_LARGE_AMOUNT",
            "Very Large Amount",
            RuleViolationSeverity.HIGH,
            "Transaction value exceeds $50,000",
            $money.value().doubleValue()
        );
        ruleEvaluationResult.addTrigger(trigger);
end