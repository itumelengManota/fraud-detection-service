import com.twenty9ine.frauddetection.domain.valueobject.GeographicContext
import com.twenty9ine.frauddetection.domain.valueobject.Transaction
import com.twenty9ine.frauddetection.domain.valueobject.RuleEvaluationResult
import com.twenty9ine.frauddetection.domain.valueobject.RuleTrigger
import com.twenty9ine.frauddetection.domain.valueobject.RuleViolationSeverity

global RuleEvaluationResult ruleEvaluationResult;

rule "Impossible Travel Detection"
    when
        $geographic : GeographicContext(impossibleTravel == true, $speed : travelSpeed)
        $tx : Transaction()
    then
        RuleTrigger trigger = new RuleTrigger(
            "IMPOSSIBLE_TRAVEL",
            "Impossible Travel",
            RuleViolationSeverity.CRITICAL,
            "Geographic impossibility detected",
            $speed
        );
        ruleEvaluationResult.addTrigger(trigger);
end
