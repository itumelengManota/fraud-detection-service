# ========================================
# Testcontainers Optimization Configuration
# ========================================
# This configuration enables significant performance improvements for integration tests
# by reusing containers across test runs instead of recreating them each time.
#
# Performance Impact:
# - Container startup time reduced from 30-60 seconds to < 1 second per test class
# - Overall test suite execution time reduced by 40-60%
# - Docker resource usage optimized
# - CI/CD pipeline execution time significantly reduced
# ========================================

# Enable container reuse across test executions
# Containers will persist after test completion and be reused in subsequent runs
# This is the single most impactful performance optimization for Testcontainers
testcontainers.reuse.enable=true

# Ryuk container timeout configuration
# Ryuk is Testcontainers' resource cleanup container that removes orphaned containers
# Increase timeout to prevent premature cleanup of reused containers
ryuk.container.timeout=60

# Container startup timeout (seconds)
# Increase if containers take longer to start on your system
# Default is 60 seconds, increased for slower systems or CI environments
testcontainers.startup.timeout=120

# Container logs configuration
# Control whether container logs are captured and displayed
# Set to false to reduce log noise during test execution
testcontainers.container.logs.enabled=true

# Parallel container startup
# Enable concurrent container initialization for faster test suite startup
testcontainers.parallel.container.startup=true

# Image pull policy
# Control when Docker images are pulled
# Options: always, cached, skip
# 'cached' is optimal for local development and CI with cached layers
testcontainers.image.pull.policy=cached

# Container check timeout
# Timeout for container health checks and readiness probes
testcontainers.reuse.check.timeout=10

# Cleanup strategy
# Control when containers are removed
# Options: on-exit, on-shutdown, manual
# 'on-shutdown' works well with reuse enabled
testcontainers.cleanup.strategy=on-shutdown

# Docker client strategy
# Configure Docker client connection strategy
# Options: default, unix-socket, tcp
testcontainers.docker.client.strategy=default

# Logging configuration
# Control Testcontainers framework logging verbosity
# Options: TRACE, DEBUG, INFO, WARN, ERROR
# Set to WARN or ERROR to reduce log noise
testcontainers.logging.level=INFO

# ========================================
# Performance Tuning Notes
# ========================================
#
# Local Development:
# - Keep reuse enabled for fastest iteration
# - Use 'cached' image pull policy
# - Consider disabling Ryuk if manually managing cleanup
#
# CI/CD Environments:
# - Keep reuse enabled if CI caches Docker state between runs
# - Use 'cached' or 'always' image pull policy depending on cache strategy
# - Increase timeouts if CI runners are resource-constrained
# - Consider Testcontainers Cloud for fastest image pulls
#
# Cleanup:
# - Run 'docker ps -a' periodically to check for orphaned containers
# - Run 'docker system prune' to clean up stopped containers and unused images
# - Reused containers are tagged with 'testcontainers' label for easy identification
#
# Troubleshooting:
# - If containers fail to reuse, check Docker Desktop settings (must allow API access)
# - Verify no port conflicts with existing containers
# - Check Docker logs: docker logs <container-id>
# - Ensure Docker has sufficient resources (CPU, memory, disk)
#
# ========================================